{"version":3,"file":"index.js","sourceRoot":"/","sources":["index.ts"],"names":[],"mappings":";;;;;AAAA,kEAA+B;AAE/B,0EAAkD;AAMlD,kBAAe,wBAAE,CACf,UACE,OAAwB,EACxB,OAA2C,EAC3C,IAA6B;IAE7B,IAAM,UAAU,GAAG,4BAAiB,CAAC,OAAO,CAAC,CAAA;IAE7C,OAAO,CAAC,OAAO,CAAC,WAAW,EAAE,UAAU,GAAG,EAAE,KAAK,EAAE,IAAI;QACrD,UAAU,CAAC,GAAG,CAAC,GAAG,EAAE,KAAK,CAAC,GAAG,EAAE,IAAI,CAAC,CAAA;IACtC,CAAC,CAAC,CAAA;IACF,IAAI,EAAE,CAAA;AACR,CAAC,EACD,EAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,4BAA4B,EAAE,CACvD,CAAA","sourcesContent":["import fp from 'fastify-plugin'\nimport { FastifyInstance } from 'fastify'\nimport permissionsPolicy from 'permissions-policy'\n\nexport interface PermissionsPolicyOptions {\n  features: Record<string, string[]>\n}\n\nexport default fp(\n  function (\n    fastify: FastifyInstance,\n    options: Readonly<PermissionsPolicyOptions>,\n    next: (error?: Error) => void,\n  ) {\n    const middleware = permissionsPolicy(options)\n\n    fastify.addHook('onRequest', function (req, reply, next) {\n      middleware(req.raw, reply.raw, next)\n    })\n    next()\n  },\n  { fastify: '3.x', name: 'fastify-permissions-policy' },\n)\n"]}